{% extends "base.html" %}
{% load currency %}
{% block title %}Checkout Â· Physiotherapy Jobs Canada{% endblock %}

{% block content %}
<h1>Checkout</h1>

{% if items %}
  <table style="width:100%;border-collapse:collapse;margin:12px 0;">
    <thead>
      <tr style="text-align:left;border-bottom:1px solid #243352;">
        <th style="padding:8px;">Package</th>
        <th style="padding:8px;">Price</th>
        <th style="padding:8px;">Qty</th>
        <th style="padding:8px;">Line Total</th>
      </tr>
    </thead>
    <tbody>
    {% for row in items %}
      <tr style="border-bottom:1px solid #243352;">
        <td style="padding:8px;">{{ row.pkg.name }}</td>
        <td style="padding:8px;">{{ row.pkg.price_cents|cents_to_currency:row.pkg.currency }}</td>
        <td style="padding:8px;">{{ row.qty }}</td>
        <td style="padding:8px;">{{ row.line_total|cents_to_currency:row.pkg.currency }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  <div style="text-align:right;margin-top:12px;">
    <div style="font-size:1.1rem;margin-bottom:12px;">
      <strong>Subtotal:</strong>
      {% if items %}{{ subtotal|cents_to_currency:items.0.pkg.currency }}{% else %}$0.00{% endif %}
    </div>

    <!-- In DEBUG we "auto-approve" orders as PAID; in prod you can hook Stripe here -->
    <form method="post">
      {% csrf_token %}
      <button class="btn" type="submit">Place Order</button>
      <a class="btn-outline" href="{% url 'package_cart_view' %}" style="margin-left:8px;">Back to Cart</a>
    </form>
  </div>
{% else %}
  <p>Your cart is empty.</p>
  <p><a class="btn" href="{% url 'package_list' %}">Browse Packages</a></p>
{% endif %}
{% endblock %}
