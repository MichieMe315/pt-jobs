{% extends "base.html" %}
{% block title %}Employer Dashboard · PT Jobs{% endblock %}
{% block content %}
<h1>Employer Dashboard</h1>

{% if not user.employer.is_approved %}
  <div class="banner warning">Your employer profile is pending approval. You can explore but cannot post or purchase yet.</div>
{% endif %}

<section class="metrics">
  <div class="metric">
    <div class="label">Credits Remaining</div>
    <div class="value">{{ user.employer.credits|default:0 }}</div>
  </div>
  {% if user.employer.credits|default:0 > 0 %}
    <a class="btn" href="{% url 'job_create' %}">Post a Job</a>
  {% endif %}
</section>

<h2>Active Jobs</h2>
<table>
  <thead><tr><th>Title</th><th>Posting</th><th>Expiry</th><th>Actions</th></tr></thead>
  <tbody>
  {% for job in active_jobs %}
    <tr>
      <td><a href="{% url 'job_detail' job.id %}">{{ job.title }}</a></td>
      <td>{{ job.posting_date }}</td>
      <td>{{ job.expiry_date }}</td>
      <td>
        <a href="{% url 'job_edit' job.id %}">Edit</a> ·
        <a href="{% url 'job_applications' job.id %}">Applications</a>
      </td>
    </tr>
  {% empty %}
    <tr><td colspan="4">No active jobs.</td></tr>
  {% endfor %}
  </tbody>
</table>

<h2>Purchased Packages</h2>
<ul>
  {% for p in purchased_packages %}
    <li>{{ p.package.name }} — remaining {{ p.credits_remaining }} (source: {{ p.source }})</li>
  {% empty %}
    <li>No purchases yet.</li>
  {% endfor %}
</ul>

<h2>Invoices</h2>
<ul>
  {% for inv in invoices %}
    <li>#{{ inv.id }} — {{ inv.created_at|date:"Y-m-d" }} — ${{ inv.amount }} — {{ inv.status }}</li>
  {% empty %}
    <li>No invoices yet.</li>
  {% endfor %}
</ul>
{% endblock %}
